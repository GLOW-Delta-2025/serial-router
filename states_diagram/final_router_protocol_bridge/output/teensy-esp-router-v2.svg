<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.1 (20251006.0113)
 -->
<!-- Title: teensy_esp_router_v2 Pages: 1 -->
<svg width="8419pt" height="791pt"
 viewBox="0.00 0.00 8419.00 791.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 787)">
<title>teensy_esp_router_v2</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-787 8414.75,-787 8414.75,4 -4,4"/>
<!-- S_IDLE_ROUTER -->
<g id="node1" class="node">
<title>S_IDLE_ROUTER</title>
<g id="a_node1"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;neutral&quot;, &quot;description&quot;: &quot;Router ready to route frames and track outstanding exchanges&quot;}">
<polygon fill="#f28c28" stroke="black" points="127.75,-344 0,-344 0,-306 127.75,-306 127.75,-344"/>
<text xml:space="preserve" text-anchor="middle" x="63.88" y="-326.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_IDLE_ROUTER</text>
<text xml:space="preserve" text-anchor="middle" x="63.88" y="-311.7" font-family="Helvetica,sans-Serif" font-size="14.00">ROUTER_IDLE</text>
</a>
</g>
</g>
<!-- S_REQ_101_MAKE_STAR -->
<g id="node2" class="node">
<title>S_REQ_101_MAKE_STAR</title>
<g id="a_node2"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC instructs the addressed arm to begin capturing microphone data for a star&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="470,-515 287.5,-515 287.5,-477 470,-477 470,-515"/>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-497.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_101_MAKE_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-482.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_MAKE_STAR</text>
</a>
</g>
</g>
<!-- S_IDLE_ROUTER&#45;&gt;S_REQ_101_MAKE_STAR -->
<g id="edge1" class="edge">
<title>S_IDLE_ROUTER&#45;&gt;S_REQ_101_MAKE_STAR</title>
<g id="a_edge1"><a xlink:title="{&quot;trigger&quot;: &quot;mic_start_event&quot;, &quot;message&quot;: &quot;ID101 MAKE_STAR&quot;, &quot;notes&quot;: &quot;MAC selects target arm; router prepends MASTER when forwarding&quot;, &quot;payload&quot;: &quot;arm_id,speed,color,brightness,size&quot;}">
<path fill="none" stroke="black" d="M70.24,-344.35C79.85,-375.05 103.09,-434.38 145.75,-463 183.51,-488.33 232.51,-497.84 275.75,-500.5"/>
<polygon fill="black" stroke="black" points="275.52,-504 285.68,-500.99 275.87,-497.01 275.52,-504"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-519.39" font-family="Times,serif" font-size="14.00">mic_start_event</text>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-502.89" font-family="Times,serif" font-size="14.00">ID101 MAKE_STAR</text>
</g>
<!-- S_REQ_301_START_IDLE -->
<g id="node22" class="node">
<title>S_REQ_301_START_IDLE</title>
<g id="a_node22"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;broadcast&quot;, &quot;description&quot;: &quot;MAC sends START_IDLE broadcast through the router to every device&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="473.75,-345 283.75,-345 283.75,-307 473.75,-307 473.75,-345"/>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-327.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_301_START_IDLE</text>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-312.7" font-family="Helvetica,sans-Serif" font-size="14.00">BROADCAST_START_IDLE</text>
</a>
</g>
</g>
<!-- S_IDLE_ROUTER&#45;&gt;S_REQ_301_START_IDLE -->
<g id="edge27" class="edge">
<title>S_IDLE_ROUTER&#45;&gt;S_REQ_301_START_IDLE</title>
<g id="a_edge27"><a xlink:title="{&quot;trigger&quot;: &quot;manual_idle_enable&quot;, &quot;message&quot;: &quot;ID301 START_IDLE&quot;, &quot;notes&quot;: &quot;MAC enables idle playback across all devices&quot;, &quot;payload&quot;: &quot;mode&quot;}">
<path fill="none" stroke="black" d="M128.19,-325.2C169.43,-325.33 224.26,-325.51 272.01,-325.66"/>
<polygon fill="black" stroke="black" points="271.83,-329.16 281.84,-325.69 271.85,-322.16 271.83,-329.16"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-345.32" font-family="Times,serif" font-size="14.00">manual_idle_enable</text>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-328.82" font-family="Times,serif" font-size="14.00">ID301 START_IDLE</text>
</g>
<!-- S_REQ_302_STOP_IDLE -->
<g id="node24" class="node">
<title>S_REQ_302_STOP_IDLE</title>
<g id="a_node24"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;broadcast&quot;, &quot;description&quot;: &quot;MAC sends STOP_IDLE broadcast to end the idle animation&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="470,-236 287.5,-236 287.5,-198 470,-198 470,-236"/>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-218.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_302_STOP_IDLE</text>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-203.7" font-family="Helvetica,sans-Serif" font-size="14.00">BROADCAST_STOP_IDLE</text>
</a>
</g>
</g>
<!-- S_IDLE_ROUTER&#45;&gt;S_REQ_302_STOP_IDLE -->
<g id="edge30" class="edge">
<title>S_IDLE_ROUTER&#45;&gt;S_REQ_302_STOP_IDLE</title>
<g id="a_edge30"><a xlink:title="{&quot;trigger&quot;: &quot;manual_idle_disable&quot;, &quot;message&quot;: &quot;ID302 STOP_IDLE&quot;, &quot;notes&quot;: &quot;MAC stops idle playback across all devices&quot;, &quot;payload&quot;: &quot;mode&quot;}">
<path fill="none" stroke="black" d="M73.97,-305.72C86.4,-281.85 111.18,-242.24 145.75,-225 185.31,-205.27 233.57,-200.98 275.8,-202.52"/>
<polygon fill="black" stroke="black" points="275.58,-206.01 285.74,-203.01 275.92,-199.02 275.58,-206.01"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-244.7" font-family="Times,serif" font-size="14.00">manual_idle_disable</text>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-228.2" font-family="Times,serif" font-size="14.00">ID302 STOP_IDLE</text>
</g>
<!-- S_REQ_303_PING -->
<g id="node26" class="node">
<title>S_REQ_303_PING</title>
<g id="a_node26"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;broadcast&quot;, &quot;description&quot;: &quot;MAC sends heartbeat PING broadcast for liveness checks&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="449.75,-127 307.75,-127 307.75,-89 449.75,-89 449.75,-127"/>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-109.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_303_PING</text>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-94.7" font-family="Helvetica,sans-Serif" font-size="14.00">BROADCAST_PING</text>
</a>
</g>
</g>
<!-- S_IDLE_ROUTER&#45;&gt;S_REQ_303_PING -->
<g id="edge33" class="edge">
<title>S_IDLE_ROUTER&#45;&gt;S_REQ_303_PING</title>
<g id="a_edge33"><a xlink:title="{&quot;trigger&quot;: &quot;heartbeat_tick&quot;, &quot;message&quot;: &quot;ID303 PING&quot;, &quot;notes&quot;: &quot;MAC sends heartbeat ping&quot;, &quot;payload&quot;: &quot;timestamp&quot;}">
<path fill="none" stroke="black" d="M65.71,-305.52C68.71,-262.78 82.49,-160.97 145.75,-116 188.63,-85.52 248.1,-84.04 296.09,-89.92"/>
<polygon fill="black" stroke="black" points="295.52,-93.37 305.9,-91.26 296.46,-86.43 295.52,-93.37"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-135.7" font-family="Times,serif" font-size="14.00">heartbeat_tick</text>
<text xml:space="preserve" text-anchor="middle" x="205.75" y="-119.2" font-family="Times,serif" font-size="14.00">ID303 PING</text>
</g>
<!-- S_REQ_304_RESET -->
<g id="node28" class="node">
<title>S_REQ_304_RESET</title>
<g id="a_node28"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;broadcast&quot;, &quot;description&quot;: &quot;MAC triggers an emergency RESET broadcast across the bus&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="3304.88,-666 3151.62,-666 3151.62,-628 3304.88,-628 3304.88,-666"/>
<text xml:space="preserve" text-anchor="middle" x="3228.25" y="-648.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_304_RESET</text>
<text xml:space="preserve" text-anchor="middle" x="3228.25" y="-633.7" font-family="Helvetica,sans-Serif" font-size="14.00">BROADCAST_RESET</text>
</a>
</g>
</g>
<!-- S_IDLE_ROUTER&#45;&gt;S_REQ_304_RESET -->
<g id="edge36" class="edge">
<title>S_IDLE_ROUTER&#45;&gt;S_REQ_304_RESET</title>
<g id="a_edge36"><a xlink:title="{&quot;trigger&quot;: &quot;operator_reset&quot;, &quot;message&quot;: &quot;ID304 RESET&quot;, &quot;notes&quot;: &quot;MAC issues emergency reset broadcast&quot;, &quot;payload&quot;: &quot;reason&quot;}">
<path fill="none" stroke="black" d="M68.95,-344.37C87.66,-427.51 173.43,-750 377.75,-750 377.75,-750 377.75,-750 2736.25,-750 2891.04,-750 3067.53,-700.36 3161.01,-670.01"/>
<polygon fill="black" stroke="black" points="3161.86,-673.41 3170.28,-666.97 3159.68,-666.76 3161.86,-673.41"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-769.7" font-family="Times,serif" font-size="14.00">operator_reset</text>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-753.2" font-family="Times,serif" font-size="14.00">ID304 RESET</text>
</g>
<!-- S_CONF_201_MAKE_STAR -->
<g id="node3" class="node">
<title>S_CONF_201_MAKE_STAR</title>
<g id="a_node3"><a xlink:title="{&quot;owner&quot;: &quot;ARM&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Arm confirms it has entered star buildup mode and is sampling parameters&quot;}">
<polygon fill="#f4c95d" stroke="black" points="890.25,-571 698.75,-571 698.75,-533 890.25,-533 890.25,-571"/>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-553.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_201_MAKE_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-538.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_MAKE_STAR</text>
</a>
</g>
</g>
<!-- S_REQ_101_MAKE_STAR&#45;&gt;S_CONF_201_MAKE_STAR -->
<g id="edge2" class="edge">
<title>S_REQ_101_MAKE_STAR&#45;&gt;S_CONF_201_MAKE_STAR</title>
<g id="a_edge2"><a xlink:title="{&quot;trigger&quot;: &quot;arm_ack_started&quot;, &quot;message&quot;: &quot;ID201 MAKE_STAR_CONFIRM&quot;, &quot;notes&quot;: &quot;Router tags arm reply with source before relaying to MAC&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M470.29,-508.26C534.27,-516.91 620.25,-528.55 687.45,-537.65"/>
<polygon fill="black" stroke="black" points="686.61,-541.06 696.99,-538.94 687.55,-534.13 686.61,-541.06"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-555.15" font-family="Times,serif" font-size="14.00">arm_ack_started</text>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-538.65" font-family="Times,serif" font-size="14.00">ID201 MAKE_STAR_CONFIRM</text>
</g>
<!-- S_REQ_103_CANCEL_STAR -->
<g id="node6" class="node">
<title>S_REQ_103_CANCEL_STAR</title>
<g id="a_node6"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC aborts a pending star buildup on the specified arm&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="1678.25,-515 1480,-515 1480,-477 1678.25,-477 1678.25,-515"/>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-497.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_103_CANCEL_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-482.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_CANCEL_STAR</text>
</a>
</g>
</g>
<!-- S_REQ_101_MAKE_STAR&#45;&gt;S_REQ_103_CANCEL_STAR -->
<g id="edge23" class="edge">
<title>S_REQ_101_MAKE_STAR&#45;&gt;S_REQ_103_CANCEL_STAR</title>
<g id="a_edge23"><a xlink:title="{&quot;trigger&quot;: &quot;mac_cancel_during_capture&quot;, &quot;message&quot;: &quot;ID103 CANCEL_STAR&quot;, &quot;notes&quot;: &quot;MAC aborts star creation while capture is ongoing&quot;, &quot;payload&quot;: &quot;arm_id&quot;}">
<path fill="none" stroke="black" d="M470.31,-496C686.79,-496 1233.6,-496 1468.33,-496"/>
<polygon fill="black" stroke="black" points="1468.09,-499.5 1478.09,-496 1468.09,-492.5 1468.09,-499.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="984.75" y="-515.7" font-family="Times,serif" font-size="14.00">mac_cancel_during_capture</text>
<text xml:space="preserve" text-anchor="middle" x="984.75" y="-499.2" font-family="Times,serif" font-size="14.00">ID103 CANCEL_STAR</text>
</g>
<!-- S_REQ_102_SEND_STAR -->
<g id="node4" class="node">
<title>S_REQ_102_SEND_STAR</title>
<g id="a_node4"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC orders the arm to stream the finalized star payload toward the router&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="1260.25,-596 1079.25,-596 1079.25,-558 1260.25,-558 1260.25,-596"/>
<text xml:space="preserve" text-anchor="middle" x="1169.75" y="-578.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_102_SEND_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="1169.75" y="-563.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_SEND_STAR</text>
</a>
</g>
</g>
<!-- S_CONF_201_MAKE_STAR&#45;&gt;S_REQ_102_SEND_STAR -->
<g id="edge3" class="edge">
<title>S_CONF_201_MAKE_STAR&#45;&gt;S_REQ_102_SEND_STAR</title>
<g id="a_edge3"><a xlink:title="{&quot;trigger&quot;: &quot;mic_session_complete&quot;, &quot;message&quot;: &quot;ID102 SEND_STAR&quot;, &quot;notes&quot;: &quot;MAC closes capture window and requests payload transfer&quot;, &quot;payload&quot;: &quot;arm_id&quot;}">
<path fill="none" stroke="black" d="M890.65,-558.37C944.81,-562 1012.61,-566.54 1067.71,-570.23"/>
<polygon fill="black" stroke="black" points="1067.19,-573.71 1077.4,-570.88 1067.66,-566.72 1067.19,-573.71"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="984.75" y="-589.31" font-family="Times,serif" font-size="14.00">mic_session_complete</text>
<text xml:space="preserve" text-anchor="middle" x="984.75" y="-572.81" font-family="Times,serif" font-size="14.00">ID102 SEND_STAR</text>
</g>
<!-- S_CONF_202_SEND_STAR -->
<g id="node5" class="node">
<title>S_CONF_202_SEND_STAR</title>
<g id="a_node5"><a xlink:title="{&quot;owner&quot;: &quot;ARM&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Arm acknowledges SEND_STAR and starts transmission on its UART link&quot;}">
<polygon fill="#f4c95d" stroke="black" points="1674.12,-604 1484.12,-604 1484.12,-566 1674.12,-566 1674.12,-604"/>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-586.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_202_SEND_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="1579.12" y="-571.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_SEND_STAR</text>
</a>
</g>
</g>
<!-- S_REQ_102_SEND_STAR&#45;&gt;S_CONF_202_SEND_STAR -->
<g id="edge4" class="edge">
<title>S_REQ_102_SEND_STAR&#45;&gt;S_CONF_202_SEND_STAR</title>
<g id="a_edge4"><a xlink:title="{&quot;trigger&quot;: &quot;arm_ack_payload&quot;, &quot;message&quot;: &quot;ID202 SEND_STAR_CONFIRM&quot;, &quot;notes&quot;: &quot;Router holds context until arm confirms transmission start&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M1260.65,-578.77C1323.23,-579.99 1406.89,-581.64 1472.63,-582.93"/>
<polygon fill="black" stroke="black" points="1472.27,-586.42 1482.33,-583.12 1472.41,-579.42 1472.27,-586.42"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1370.12" y="-602.34" font-family="Times,serif" font-size="14.00">arm_ack_payload</text>
<text xml:space="preserve" text-anchor="middle" x="1370.12" y="-585.84" font-family="Times,serif" font-size="14.00">ID202 SEND_STAR_CONFIRM</text>
</g>
<!-- S_REQ_102_SEND_STAR&#45;&gt;S_REQ_103_CANCEL_STAR -->
<g id="edge24" class="edge">
<title>S_REQ_102_SEND_STAR&#45;&gt;S_REQ_103_CANCEL_STAR</title>
<g id="a_edge24"><a xlink:title="{&quot;trigger&quot;: &quot;mac_cancel_during_send&quot;, &quot;message&quot;: &quot;ID103 CANCEL_STAR&quot;, &quot;notes&quot;: &quot;MAC aborts star creation while payload is in flight&quot;, &quot;payload&quot;: &quot;arm_id&quot;}">
<path fill="none" stroke="black" d="M1224.67,-557.55C1241.65,-551.94 1260.59,-546.2 1278.25,-542 1340.58,-527.18 1411.38,-516.05 1468.53,-508.46"/>
<polygon fill="black" stroke="black" points="1468.81,-511.96 1478.27,-507.19 1467.9,-505.02 1468.81,-511.96"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1370.12" y="-561.7" font-family="Times,serif" font-size="14.00">mac_cancel_during_send</text>
<text xml:space="preserve" text-anchor="middle" x="1370.12" y="-545.2" font-family="Times,serif" font-size="14.00">ID103 CANCEL_STAR</text>
</g>
<!-- S_ERR_500_COMM_ERROR -->
<g id="node30" class="node">
<title>S_ERR_500_COMM_ERROR</title>
<g id="a_node30"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;error&quot;, &quot;description&quot;: &quot;Router surfaces communication errors or timeouts to the MAC for recovery&quot;}">
<polygon fill="#f28c28" stroke="black" points="2835.5,-666 2635,-666 2635,-628 2835.5,-628 2835.5,-666"/>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-648.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_ERR_500_COMM_ERROR</text>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-633.7" font-family="Helvetica,sans-Serif" font-size="14.00">COMM_ERROR</text>
</a>
</g>
</g>
<!-- S_REQ_102_SEND_STAR&#45;&gt;S_ERR_500_COMM_ERROR -->
<g id="edge39" class="edge">
<title>S_REQ_102_SEND_STAR&#45;&gt;S_ERR_500_COMM_ERROR</title>
<g id="a_edge39"><a xlink:title="{&quot;trigger&quot;: &quot;router_timeout&quot;, &quot;message&quot;: &quot;ID500 COMM_ERROR&quot;, &quot;notes&quot;: &quot;Router escalates timeout while waiting for SEND_STAR payload&quot;, &quot;payload&quot;: &quot;device_id,error_code,error_text&quot;}">
<path fill="none" stroke="black" d="M1212.23,-596.38C1284.76,-628.44 1440.05,-689 1578.12,-689 1578.12,-689 1578.12,-689 2337,-689 2461.7,-689 2493.4,-687.54 2617,-671 2622.86,-670.22 2628.86,-669.31 2634.9,-668.32"/>
<polygon fill="black" stroke="black" points="2635.04,-671.85 2644.31,-666.71 2633.86,-664.95 2635.04,-671.85"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-708.7" font-family="Times,serif" font-size="14.00">router_timeout</text>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-692.2" font-family="Times,serif" font-size="14.00">ID500 COMM_ERROR</text>
</g>
<!-- S_REQ_104_STAR_ARRIVED -->
<g id="node8" class="node">
<title>S_REQ_104_STAR_ARRIVED</title>
<g id="a_node8"><a xlink:title="{&quot;owner&quot;: &quot;ARM&quot;, &quot;role&quot;: &quot;notify&quot;, &quot;description&quot;: &quot;Arm reports that its star payload reached the centerpiece ingress queue&quot;}">
<polygon fill="#f4c95d" stroke="black" points="2122.12,-533 1918.62,-533 1918.62,-495 2122.12,-495 2122.12,-533"/>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-515.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_104_STAR_ARRIVED</text>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-500.7" font-family="Helvetica,sans-Serif" font-size="14.00">REPORT_STAR_ARRIVED</text>
</a>
</g>
</g>
<!-- S_CONF_202_SEND_STAR&#45;&gt;S_REQ_104_STAR_ARRIVED -->
<g id="edge6" class="edge">
<title>S_CONF_202_SEND_STAR&#45;&gt;S_REQ_104_STAR_ARRIVED</title>
<g id="a_edge6"><a xlink:title="{&quot;trigger&quot;: &quot;arm_status_forward&quot;, &quot;message&quot;: &quot;ID104 STAR_ARRIVED&quot;, &quot;notes&quot;: &quot;Router pushes arm perspective update upstream to MAC&quot;, &quot;payload&quot;: &quot;arm_id,status&quot;}">
<path fill="none" stroke="black" d="M1674.62,-569.73C1742.72,-558.72 1834.89,-543.82 1906.8,-532.2"/>
<polygon fill="black" stroke="black" points="1907.35,-535.65 1916.66,-530.6 1906.23,-528.74 1907.35,-535.65"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1797.5" y="-585.66" font-family="Times,serif" font-size="14.00">arm_status_forward</text>
<text xml:space="preserve" text-anchor="middle" x="1797.5" y="-569.16" font-family="Times,serif" font-size="14.00">ID104 STAR_ARRIVED</text>
</g>
<!-- S_REQ_105_ADD_STAR -->
<g id="node9" class="node">
<title>S_REQ_105_ADD_STAR</title>
<g id="a_node9"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC forwards ADD_STAR toward CENTER or TOP after router rewrites addressing&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="2422,-622 2250,-622 2250,-584 2422,-584 2422,-622"/>
<text xml:space="preserve" text-anchor="middle" x="2336" y="-604.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_105_ADD_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="2336" y="-589.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_ADD_STAR</text>
</a>
</g>
</g>
<!-- S_CONF_202_SEND_STAR&#45;&gt;S_REQ_105_ADD_STAR -->
<g id="edge5" class="edge">
<title>S_CONF_202_SEND_STAR&#45;&gt;S_REQ_105_ADD_STAR</title>
<g id="a_edge5"><a xlink:title="{&quot;trigger&quot;: &quot;router_dispatch_to_center&quot;, &quot;message&quot;: &quot;ID105 ADD_STAR&quot;, &quot;notes&quot;: &quot;Router rewrites destination to CENTER or TOP and forwards bulk payload&quot;, &quot;payload&quot;: &quot;device_id,star_payload&quot;}">
<path fill="none" stroke="black" d="M1674.41,-600.86C1681.79,-601.72 1689.13,-602.45 1696.25,-603 1887.9,-617.77 2112.87,-612.54 2238.16,-607.62"/>
<polygon fill="black" stroke="black" points="2238.24,-611.12 2248.09,-607.22 2237.96,-604.12 2238.24,-611.12"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-632.39" font-family="Times,serif" font-size="14.00">router_dispatch_to_center</text>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-615.89" font-family="Times,serif" font-size="14.00">ID105 ADD_STAR</text>
</g>
<!-- S_CONF_203_CANCEL_STAR -->
<g id="node7" class="node">
<title>S_CONF_203_CANCEL_STAR</title>
<g id="a_node7"><a xlink:title="{&quot;owner&quot;: &quot;ARM&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Arm reports cancellation completed and local buffers cleared&quot;}">
<polygon fill="#f4c95d" stroke="black" points="2124,-477 1916.75,-477 1916.75,-439 2124,-439 2124,-477"/>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-459.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_203_CANCEL_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-444.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_CANCEL_STAR</text>
</a>
</g>
</g>
<!-- S_REQ_103_CANCEL_STAR&#45;&gt;S_CONF_203_CANCEL_STAR -->
<g id="edge25" class="edge">
<title>S_REQ_103_CANCEL_STAR&#45;&gt;S_CONF_203_CANCEL_STAR</title>
<g id="a_edge25"><a xlink:title="{&quot;trigger&quot;: &quot;arm_ack_cancel&quot;, &quot;message&quot;: &quot;ID203 CANCEL_STAR_CONFIRM&quot;, &quot;notes&quot;: &quot;Arm confirms cancellation&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M1678.7,-487.47C1745.93,-481.66 1835.16,-473.94 1905.44,-467.86"/>
<polygon fill="black" stroke="black" points="1905.38,-471.38 1915.04,-467.03 1904.77,-464.4 1905.38,-471.38"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1797.5" y="-505.51" font-family="Times,serif" font-size="14.00">arm_ack_cancel</text>
<text xml:space="preserve" text-anchor="middle" x="1797.5" y="-489.01" font-family="Times,serif" font-size="14.00">ID203 CANCEL_STAR_CONFIRM</text>
</g>
<!-- S_CONF_203_CANCEL_STAR&#45;&gt;S_IDLE_ROUTER -->
<g id="edge26" class="edge">
<title>S_CONF_203_CANCEL_STAR&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge26"><a xlink:title="{&quot;trigger&quot;: &quot;router_drop_context&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router clears cancelled star context&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M1916.44,-454.7C1827.43,-452.13 1695.3,-449 1580.12,-449 377.75,-449 377.75,-449 377.75,-449 274.09,-449 236.87,-474.42 145.75,-425 116.34,-409.05 93.65,-377.52 79.89,-354.1"/>
<polygon fill="black" stroke="black" points="83.08,-352.63 75.12,-345.64 76.98,-356.07 83.08,-352.63"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="984.75" y="-452.2" font-family="Times,serif" font-size="14.00">router_drop_context</text>
</g>
<!-- S_REQ_104_STAR_ARRIVED&#45;&gt;S_REQ_104_STAR_ARRIVED -->
<g id="edge7" class="edge">
<title>S_REQ_104_STAR_ARRIVED&#45;&gt;S_REQ_104_STAR_ARRIVED</title>
<g id="a_edge7"><a xlink:title="{&quot;trigger&quot;: &quot;router_ack_to_esp&quot;, &quot;message&quot;: &quot;ID104 STAR_ARRIVED&quot;, &quot;notes&quot;: &quot;Router emits CONFIRM:STAR_ARRIVED{status=received} back to ESP before returning to MAC&quot;, &quot;payload&quot;: &quot;arm_id,status&quot;}">
<path fill="none" stroke="black" d="M1989.9,-533.42C1986.13,-542.76 1996.29,-551 2020.38,-551 2033.92,-551 2043.06,-548.39 2047.8,-544.45"/>
<polygon fill="black" stroke="black" points="2051.15,-545.45 2050.45,-534.88 2044.41,-543.58 2051.15,-545.45"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-570.7" font-family="Times,serif" font-size="14.00">router_ack_to_esp</text>
<text xml:space="preserve" text-anchor="middle" x="2020.38" y="-554.2" font-family="Times,serif" font-size="14.00">ID104 STAR_ARRIVED</text>
</g>
<!-- S_REQ_104_STAR_ARRIVED&#45;&gt;S_REQ_105_ADD_STAR -->
<g id="edge8" class="edge">
<title>S_REQ_104_STAR_ARRIVED&#45;&gt;S_REQ_105_ADD_STAR</title>
<g id="a_edge8"><a xlink:title="{&quot;trigger&quot;: &quot;router_autoroute&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Status update primes MAC to ensure ADD_STAR fan&#45;out continues&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M2089.81,-533.42C2138.59,-547.26 2204.31,-565.91 2255.43,-580.42"/>
<polygon fill="black" stroke="black" points="2254.41,-583.77 2264.98,-583.13 2256.32,-577.03 2254.41,-583.77"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2187" y="-574.87" font-family="Times,serif" font-size="14.00">router_autoroute</text>
</g>
<!-- S_CONF_205_ADD_STAR -->
<g id="node10" class="node">
<title>S_CONF_205_ADD_STAR</title>
<g id="a_node10"><a xlink:title="{&quot;owner&quot;: &quot;CENTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Center or Top confirms the star payload has been stored safely&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="2825.75,-558 2644.75,-558 2644.75,-520 2825.75,-520 2825.75,-558"/>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-540.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_205_ADD_STAR</text>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-525.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_ADD_STAR</text>
</a>
</g>
</g>
<!-- S_REQ_105_ADD_STAR&#45;&gt;S_CONF_205_ADD_STAR -->
<g id="edge9" class="edge">
<title>S_REQ_105_ADD_STAR&#45;&gt;S_CONF_205_ADD_STAR</title>
<g id="a_edge9"><a xlink:title="{&quot;trigger&quot;: &quot;center_ack_buffered&quot;, &quot;message&quot;: &quot;ID205 ADD_STAR_CONFIRM&quot;, &quot;notes&quot;: &quot;Centerpiece confirms storage; router clears pending payload flag&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M2413.3,-583.52C2422.27,-581.52 2431.32,-579.62 2440,-578 2503.87,-566.05 2576.21,-556.41 2633.18,-549.71"/>
<polygon fill="black" stroke="black" points="2633.33,-553.21 2642.86,-548.58 2632.52,-546.26 2633.33,-553.21"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2528.5" y="-597.7" font-family="Times,serif" font-size="14.00">center_ack_buffered</text>
<text xml:space="preserve" text-anchor="middle" x="2528.5" y="-581.2" font-family="Times,serif" font-size="14.00">ID205 ADD_STAR_CONFIRM</text>
</g>
<!-- S_REQ_105_ADD_STAR&#45;&gt;S_ERR_500_COMM_ERROR -->
<g id="edge40" class="edge">
<title>S_REQ_105_ADD_STAR&#45;&gt;S_ERR_500_COMM_ERROR</title>
<g id="a_edge40"><a xlink:title="{&quot;trigger&quot;: &quot;center_timeout&quot;, &quot;message&quot;: &quot;ID500 COMM_ERROR&quot;, &quot;notes&quot;: &quot;Router escalates timeout waiting for center or top ACK&quot;, &quot;payload&quot;: &quot;device_id,error_code,error_text&quot;}">
<path fill="none" stroke="black" d="M2422.22,-612.44C2481.04,-618.95 2559.82,-627.68 2623.5,-634.73"/>
<polygon fill="black" stroke="black" points="2622.97,-638.2 2633.29,-635.82 2623.74,-631.24 2622.97,-638.2"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2528.5" y="-653.7" font-family="Times,serif" font-size="14.00">center_timeout</text>
<text xml:space="preserve" text-anchor="middle" x="2528.5" y="-637.2" font-family="Times,serif" font-size="14.00">ID500 COMM_ERROR</text>
</g>
<!-- S_REQ_106_BUILDUP_CLIMAX_CENTER -->
<g id="node11" class="node">
<title>S_REQ_106_BUILDUP_CLIMAX_CENTER</title>
<g id="a_node11"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC accelerates centerpiece buildup animation tempo&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="3368.25,-503 3088.25,-503 3088.25,-465 3368.25,-465 3368.25,-503"/>
<text xml:space="preserve" text-anchor="middle" x="3228.25" y="-485.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_106_BUILDUP_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="3228.25" y="-470.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_BUILDUP_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_CONF_205_ADD_STAR&#45;&gt;S_REQ_106_BUILDUP_CLIMAX_CENTER -->
<g id="edge10" class="edge">
<title>S_CONF_205_ADD_STAR&#45;&gt;S_REQ_106_BUILDUP_CLIMAX_CENTER</title>
<g id="a_edge10"><a xlink:title="{&quot;trigger&quot;: &quot;mac_drives_buildup&quot;, &quot;message&quot;: &quot;ID106 BUILDUP_CLIMAX_CENTER&quot;, &quot;notes&quot;: &quot;MAC advances buildup pacing once minimum stars arrive&quot;, &quot;payload&quot;: &quot;buildup_time_ms&quot;}">
<path fill="none" stroke="black" d="M2826.02,-528.94C2896,-521.11 2994.73,-510.05 3076.74,-500.86"/>
<polygon fill="black" stroke="black" points="3076.88,-504.37 3086.43,-499.77 3076.1,-497.41 3076.88,-504.37"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2961.88" y="-545.41" font-family="Times,serif" font-size="14.00">mac_drives_buildup</text>
<text xml:space="preserve" text-anchor="middle" x="2961.88" y="-528.91" font-family="Times,serif" font-size="14.00">ID106 BUILDUP_CLIMAX_CENTER</text>
</g>
<!-- S_CONF_206_BUILDUP_CLIMAX_CENTER -->
<g id="node12" class="node">
<title>S_CONF_206_BUILDUP_CLIMAX_CENTER</title>
<g id="a_node12"><a xlink:title="{&quot;owner&quot;: &quot;CENTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Centerpiece acknowledges the buildup speed change&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="3979,-446 3690,-446 3690,-408 3979,-408 3979,-446"/>
<text xml:space="preserve" text-anchor="middle" x="3834.5" y="-428.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_206_BUILDUP_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="3834.5" y="-413.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_BUILDUP_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_REQ_106_BUILDUP_CLIMAX_CENTER&#45;&gt;S_CONF_206_BUILDUP_CLIMAX_CENTER -->
<g id="edge11" class="edge">
<title>S_REQ_106_BUILDUP_CLIMAX_CENTER&#45;&gt;S_CONF_206_BUILDUP_CLIMAX_CENTER</title>
<g id="a_edge11"><a xlink:title="{&quot;trigger&quot;: &quot;center_ack_buildup&quot;, &quot;message&quot;: &quot;ID206 BUILDUP_CLIMAX_CENTER_CONFIRM&quot;, &quot;notes&quot;: &quot;Centerpiece confirms new buildup timing&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M3368.64,-470.85C3461.17,-462.12 3582.73,-450.66 3678.33,-441.64"/>
<polygon fill="black" stroke="black" points="3678.43,-445.14 3688.06,-440.72 3677.77,-438.17 3678.43,-445.14"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="3529.12" y="-488.41" font-family="Times,serif" font-size="14.00">center_ack_buildup</text>
<text xml:space="preserve" text-anchor="middle" x="3529.12" y="-471.91" font-family="Times,serif" font-size="14.00">ID206 BUILDUP_CLIMAX_CENTER_CONFIRM</text>
</g>
<!-- S_REQ_107_CLIMAX_READY -->
<g id="node13" class="node">
<title>S_REQ_107_CLIMAX_READY</title>
<g id="a_node13"><a xlink:title="{&quot;owner&quot;: &quot;CENTER&quot;, &quot;role&quot;: &quot;notify&quot;, &quot;description&quot;: &quot;Centerpiece announces that the climax threshold has been reached&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="4365.5,-442 4160.5,-442 4160.5,-404 4365.5,-404 4365.5,-442"/>
<text xml:space="preserve" text-anchor="middle" x="4263" y="-424.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_107_CLIMAX_READY</text>
<text xml:space="preserve" text-anchor="middle" x="4263" y="-409.7" font-family="Helvetica,sans-Serif" font-size="14.00">REPORT_CLIMAX_READY</text>
</a>
</g>
</g>
<!-- S_CONF_206_BUILDUP_CLIMAX_CENTER&#45;&gt;S_REQ_107_CLIMAX_READY -->
<g id="edge12" class="edge">
<title>S_CONF_206_BUILDUP_CLIMAX_CENTER&#45;&gt;S_REQ_107_CLIMAX_READY</title>
<g id="a_edge12"><a xlink:title="{&quot;trigger&quot;: &quot;center_threshold_met&quot;, &quot;message&quot;: &quot;ID107 CLIMAX_READY&quot;, &quot;notes&quot;: &quot;Centerpiece notifies MAC that climax conditions are satisfied&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M3979.3,-425.65C4034.61,-425.13 4096.92,-424.55 4148.94,-424.06"/>
<polygon fill="black" stroke="black" points="4148.73,-427.56 4158.7,-423.97 4148.67,-420.56 4148.73,-427.56"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="4069.75" y="-445.18" font-family="Times,serif" font-size="14.00">center_threshold_met</text>
<text xml:space="preserve" text-anchor="middle" x="4069.75" y="-428.68" font-family="Times,serif" font-size="14.00">ID107 CLIMAX_READY</text>
</g>
<!-- S_REQ_107_CLIMAX_READY&#45;&gt;S_REQ_107_CLIMAX_READY -->
<g id="edge13" class="edge">
<title>S_REQ_107_CLIMAX_READY&#45;&gt;S_REQ_107_CLIMAX_READY</title>
<g id="a_edge13"><a xlink:title="{&quot;trigger&quot;: &quot;router_ack_to_esp&quot;, &quot;message&quot;: &quot;ID107 CLIMAX_READY&quot;, &quot;notes&quot;: &quot;Router replies to ESP with CONFIRM:CLIMAX_READY{status=forwarded} before relaying to MAC&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M4227.65,-442.42C4223.29,-451.76 4235.07,-460 4263,-460 4279.15,-460 4289.9,-457.24 4295.25,-453.12"/>
<polygon fill="black" stroke="black" points="4298.51,-454.45 4297.93,-443.87 4291.79,-452.5 4298.51,-454.45"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="4263" y="-479.7" font-family="Times,serif" font-size="14.00">router_ack_to_esp</text>
<text xml:space="preserve" text-anchor="middle" x="4263" y="-463.2" font-family="Times,serif" font-size="14.00">ID107 CLIMAX_READY</text>
</g>
<!-- S_REQ_108_START_CLIMAX_CENTER -->
<g id="node14" class="node">
<title>S_REQ_108_START_CLIMAX_CENTER</title>
<g id="a_node14"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC authorizes the centerpiece to eject queued stars toward the top piece&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="4868.25,-439 4602.5,-439 4602.5,-401 4868.25,-401 4868.25,-439"/>
<text xml:space="preserve" text-anchor="middle" x="4735.38" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_108_START_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="4735.38" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_START_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_REQ_107_CLIMAX_READY&#45;&gt;S_REQ_108_START_CLIMAX_CENTER -->
<g id="edge14" class="edge">
<title>S_REQ_107_CLIMAX_READY&#45;&gt;S_REQ_108_START_CLIMAX_CENTER</title>
<g id="a_edge14"><a xlink:title="{&quot;trigger&quot;: &quot;mac_authorizes_climax&quot;, &quot;message&quot;: &quot;ID108 START_CLIMAX_CENTER&quot;, &quot;notes&quot;: &quot;MAC grants centerpiece permission to start ejecting stars&quot;, &quot;payload&quot;: &quot;climax_time_ms&quot;}">
<path fill="none" stroke="black" d="M4365.77,-422.35C4431.68,-421.93 4518.47,-421.38 4591.28,-420.91"/>
<polygon fill="black" stroke="black" points="4590.89,-424.42 4600.87,-420.85 4590.84,-417.42 4590.89,-424.42"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="4484" y="-441.9" font-family="Times,serif" font-size="14.00">mac_authorizes_climax</text>
<text xml:space="preserve" text-anchor="middle" x="4484" y="-425.4" font-family="Times,serif" font-size="14.00">ID108 START_CLIMAX_CENTER</text>
</g>
<!-- S_CONF_208_START_CLIMAX_CENTER -->
<g id="node15" class="node">
<title>S_CONF_208_START_CLIMAX_CENTER</title>
<g id="a_node15"><a xlink:title="{&quot;owner&quot;: &quot;CENTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Centerpiece confirms it has started ejecting stars during climax&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="5449,-439 5174.25,-439 5174.25,-401 5449,-401 5449,-439"/>
<text xml:space="preserve" text-anchor="middle" x="5311.62" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_208_START_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="5311.62" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_START_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_REQ_108_START_CLIMAX_CENTER&#45;&gt;S_CONF_208_START_CLIMAX_CENTER -->
<g id="edge15" class="edge">
<title>S_REQ_108_START_CLIMAX_CENTER&#45;&gt;S_CONF_208_START_CLIMAX_CENTER</title>
<g id="a_edge15"><a xlink:title="{&quot;trigger&quot;: &quot;center_ack_climax&quot;, &quot;message&quot;: &quot;ID208 START_CLIMAX_CENTER_CONFIRM&quot;, &quot;notes&quot;: &quot;Centerpiece confirms climax execution&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M4868.48,-420C4956.31,-420 5071.77,-420 5162.68,-420"/>
<polygon fill="black" stroke="black" points="5162.41,-423.5 5172.41,-420 5162.41,-416.5 5162.41,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="5021.25" y="-439.7" font-family="Times,serif" font-size="14.00">center_ack_climax</text>
<text xml:space="preserve" text-anchor="middle" x="5021.25" y="-423.2" font-family="Times,serif" font-size="14.00">ID208 START_CLIMAX_CENTER_CONFIRM</text>
</g>
<!-- S_REQ_109_START_CLIMAX_TOP -->
<g id="node16" class="node">
<title>S_REQ_109_START_CLIMAX_TOP</title>
<g id="a_node16"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC commands the top piece to start its launch choreography&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="5897,-439 5659,-439 5659,-401 5897,-401 5897,-439"/>
<text xml:space="preserve" text-anchor="middle" x="5778" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_109_START_CLIMAX_TOP</text>
<text xml:space="preserve" text-anchor="middle" x="5778" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_START_CLIMAX_TOP</text>
</a>
</g>
</g>
<!-- S_CONF_208_START_CLIMAX_CENTER&#45;&gt;S_REQ_109_START_CLIMAX_TOP -->
<g id="edge16" class="edge">
<title>S_CONF_208_START_CLIMAX_CENTER&#45;&gt;S_REQ_109_START_CLIMAX_TOP</title>
<g id="a_edge16"><a xlink:title="{&quot;trigger&quot;: &quot;mac_orchestrates_top&quot;, &quot;message&quot;: &quot;ID109 START_CLIMAX_TOP&quot;, &quot;notes&quot;: &quot;Router retargets command to TOP with MASTER source header&quot;, &quot;payload&quot;: &quot;climax_time_ms&quot;}">
<path fill="none" stroke="black" d="M5449.44,-420C5512.03,-420 5585.81,-420 5647.48,-420"/>
<polygon fill="black" stroke="black" points="5647.34,-423.5 5657.34,-420 5647.34,-416.5 5647.34,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="5554" y="-439.7" font-family="Times,serif" font-size="14.00">mac_orchestrates_top</text>
<text xml:space="preserve" text-anchor="middle" x="5554" y="-423.2" font-family="Times,serif" font-size="14.00">ID109 START_CLIMAX_TOP</text>
</g>
<!-- S_CONF_209_START_CLIMAX_TOP -->
<g id="node17" class="node">
<title>S_CONF_209_START_CLIMAX_TOP</title>
<g id="a_node17"><a xlink:title="{&quot;owner&quot;: &quot;TOP&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Top piece confirms launch sequence&quot;}">
<polygon fill="#f28c28" stroke="black" points="6423,-439 6176,-439 6176,-401 6423,-401 6423,-439"/>
<text xml:space="preserve" text-anchor="middle" x="6299.5" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_209_START_CLIMAX_TOP</text>
<text xml:space="preserve" text-anchor="middle" x="6299.5" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_START_CLIMAX_TOP</text>
</a>
</g>
</g>
<!-- S_REQ_109_START_CLIMAX_TOP&#45;&gt;S_CONF_209_START_CLIMAX_TOP -->
<g id="edge17" class="edge">
<title>S_REQ_109_START_CLIMAX_TOP&#45;&gt;S_CONF_209_START_CLIMAX_TOP</title>
<g id="a_edge17"><a xlink:title="{&quot;trigger&quot;: &quot;top_ack_launch&quot;, &quot;message&quot;: &quot;ID209 START_CLIMAX_TOP_CONFIRM&quot;, &quot;notes&quot;: &quot;Top piece confirms launch sequence&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M5897.21,-420C5976.71,-420 6081.67,-420 6164.31,-420"/>
<polygon fill="black" stroke="black" points="6164.3,-423.5 6174.3,-420 6164.3,-416.5 6164.3,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="6036.5" y="-439.7" font-family="Times,serif" font-size="14.00">top_ack_launch</text>
<text xml:space="preserve" text-anchor="middle" x="6036.5" y="-423.2" font-family="Times,serif" font-size="14.00">ID209 START_CLIMAX_TOP_CONFIRM</text>
</g>
<!-- S_REQ_110_STOP_CLIMAX_CENTER -->
<g id="node18" class="node">
<title>S_REQ_110_STOP_CLIMAX_CENTER</title>
<g id="a_node18"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC issues a manual stop for the centerpiece climax motion&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="6908.5,-439 6650.25,-439 6650.25,-401 6908.5,-401 6908.5,-439"/>
<text xml:space="preserve" text-anchor="middle" x="6779.38" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_110_STOP_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="6779.38" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_STOP_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_CONF_209_START_CLIMAX_TOP&#45;&gt;S_REQ_110_STOP_CLIMAX_CENTER -->
<g id="edge18" class="edge">
<title>S_CONF_209_START_CLIMAX_TOP&#45;&gt;S_REQ_110_STOP_CLIMAX_CENTER</title>
<g id="a_edge18"><a xlink:title="{&quot;trigger&quot;: &quot;mac_manual_override&quot;, &quot;message&quot;: &quot;ID110 STOP_CLIMAX_CENTER&quot;, &quot;notes&quot;: &quot;MAC issues center stop when manual override is triggered&quot;, &quot;payload&quot;: &quot;reason&quot;}">
<path fill="none" stroke="black" d="M6423.25,-420C6489.14,-420 6570.6,-420 6638.87,-420"/>
<polygon fill="black" stroke="black" points="6638.63,-423.5 6648.63,-420 6638.63,-416.5 6638.63,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="6536.62" y="-439.7" font-family="Times,serif" font-size="14.00">mac_manual_override</text>
<text xml:space="preserve" text-anchor="middle" x="6536.62" y="-423.2" font-family="Times,serif" font-size="14.00">ID110 STOP_CLIMAX_CENTER</text>
</g>
<!-- S_CONF_210_STOP_CLIMAX_CENTER -->
<g id="node19" class="node">
<title>S_CONF_210_STOP_CLIMAX_CENTER</title>
<g id="a_node19"><a xlink:title="{&quot;owner&quot;: &quot;CENTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Centerpiece reports it halted the climax routine&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="7472,-439 7204.75,-439 7204.75,-401 7472,-401 7472,-439"/>
<text xml:space="preserve" text-anchor="middle" x="7338.38" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_210_STOP_CLIMAX_CENTER</text>
<text xml:space="preserve" text-anchor="middle" x="7338.38" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_STOP_CLIMAX_CENTER</text>
</a>
</g>
</g>
<!-- S_REQ_110_STOP_CLIMAX_CENTER&#45;&gt;S_CONF_210_STOP_CLIMAX_CENTER -->
<g id="edge19" class="edge">
<title>S_REQ_110_STOP_CLIMAX_CENTER&#45;&gt;S_CONF_210_STOP_CLIMAX_CENTER</title>
<g id="a_edge19"><a xlink:title="{&quot;trigger&quot;: &quot;center_ack_stop&quot;, &quot;message&quot;: &quot;ID210 STOP_CLIMAX_CENTER_CONFIRM&quot;, &quot;notes&quot;: &quot;Centerpiece halts climax operations&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M6908.86,-420C6993.81,-420 7105.3,-420 7193.27,-420"/>
<polygon fill="black" stroke="black" points="7193.18,-423.5 7203.18,-420 7193.18,-416.5 7193.18,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="7056.62" y="-439.7" font-family="Times,serif" font-size="14.00">center_ack_stop</text>
<text xml:space="preserve" text-anchor="middle" x="7056.62" y="-423.2" font-family="Times,serif" font-size="14.00">ID210 STOP_CLIMAX_CENTER_CONFIRM</text>
</g>
<!-- S_REQ_111_STOP_CLIMAX_TOP -->
<g id="node20" class="node">
<title>S_REQ_111_STOP_CLIMAX_TOP</title>
<g id="a_node20"><a xlink:title="{&quot;owner&quot;: &quot;MAC&quot;, &quot;role&quot;: &quot;request&quot;, &quot;description&quot;: &quot;MAC issues a manual stop for the top piece launch&quot;}">
<polygon fill="#5d8aa8" stroke="black" points="7902,-439 7672.25,-439 7672.25,-401 7902,-401 7902,-439"/>
<text xml:space="preserve" text-anchor="middle" x="7787.12" y="-421.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_REQ_111_STOP_CLIMAX_TOP</text>
<text xml:space="preserve" text-anchor="middle" x="7787.12" y="-406.7" font-family="Helvetica,sans-Serif" font-size="14.00">REQUEST_STOP_CLIMAX_TOP</text>
</a>
</g>
</g>
<!-- S_CONF_210_STOP_CLIMAX_CENTER&#45;&gt;S_REQ_111_STOP_CLIMAX_TOP -->
<g id="edge20" class="edge">
<title>S_CONF_210_STOP_CLIMAX_CENTER&#45;&gt;S_REQ_111_STOP_CLIMAX_TOP</title>
<g id="a_edge20"><a xlink:title="{&quot;trigger&quot;: &quot;mac_followup_stop&quot;, &quot;message&quot;: &quot;ID111 STOP_CLIMAX_TOP&quot;, &quot;notes&quot;: &quot;MAC cascades stop to the top piece&quot;, &quot;payload&quot;: &quot;reason&quot;}">
<path fill="none" stroke="black" d="M7472.21,-420C7531.89,-420 7601.95,-420 7660.73,-420"/>
<polygon fill="black" stroke="black" points="7660.43,-423.5 7670.43,-420 7660.43,-416.5 7660.43,-423.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="7572.12" y="-439.7" font-family="Times,serif" font-size="14.00">mac_followup_stop</text>
<text xml:space="preserve" text-anchor="middle" x="7572.12" y="-423.2" font-family="Times,serif" font-size="14.00">ID111 STOP_CLIMAX_TOP</text>
</g>
<!-- S_CONF_211_STOP_CLIMAX_TOP -->
<g id="node21" class="node">
<title>S_CONF_211_STOP_CLIMAX_TOP</title>
<g id="a_node21"><a xlink:title="{&quot;owner&quot;: &quot;TOP&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Top piece reports it halted the launch routine&quot;}">
<polygon fill="#f28c28" stroke="black" points="8410.75,-408 8171.25,-408 8171.25,-370 8410.75,-370 8410.75,-408"/>
<text xml:space="preserve" text-anchor="middle" x="8291" y="-390.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_211_STOP_CLIMAX_TOP</text>
<text xml:space="preserve" text-anchor="middle" x="8291" y="-375.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_STOP_CLIMAX_TOP</text>
</a>
</g>
</g>
<!-- S_REQ_111_STOP_CLIMAX_TOP&#45;&gt;S_CONF_211_STOP_CLIMAX_TOP -->
<g id="edge21" class="edge">
<title>S_REQ_111_STOP_CLIMAX_TOP&#45;&gt;S_CONF_211_STOP_CLIMAX_TOP</title>
<g id="a_edge21"><a xlink:title="{&quot;trigger&quot;: &quot;top_ack_stop&quot;, &quot;message&quot;: &quot;ID211 STOP_CLIMAX_TOP_CONFIRM&quot;, &quot;notes&quot;: &quot;Top piece confirms stop&quot;, &quot;payload&quot;: &quot;request_id,status&quot;}">
<path fill="none" stroke="black" d="M7902.32,-412.95C7978.98,-408.21 8080.16,-401.96 8159.93,-397.03"/>
<polygon fill="black" stroke="black" points="8159.76,-400.55 8169.53,-396.44 8159.33,-393.56 8159.76,-400.55"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="8036.62" y="-431.39" font-family="Times,serif" font-size="14.00">top_ack_stop</text>
<text xml:space="preserve" text-anchor="middle" x="8036.62" y="-414.89" font-family="Times,serif" font-size="14.00">ID211 STOP_CLIMAX_TOP_CONFIRM</text>
</g>
<!-- S_CONF_211_STOP_CLIMAX_TOP&#45;&gt;S_IDLE_ROUTER -->
<g id="edge22" class="edge">
<title>S_CONF_211_STOP_CLIMAX_TOP&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge22"><a xlink:title="{&quot;trigger&quot;: &quot;router_clear_context&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router releases climax state and returns to idle&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M8170.89,-383.07C8069.22,-378.51 7919.11,-373 7788.12,-373 377.75,-373 377.75,-373 377.75,-373 274.45,-373 246.35,-382.46 145.75,-359 135.18,-356.54 124.23,-352.81 113.93,-348.71"/>
<polygon fill="black" stroke="black" points="115.45,-345.55 104.87,-344.93 112.75,-352.01 115.45,-345.55"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="3834.5" y="-376.2" font-family="Times,serif" font-size="14.00">router_clear_context</text>
</g>
<!-- S_CONF_401_START_IDLE -->
<g id="node23" class="node">
<title>S_CONF_401_START_IDLE</title>
<g id="a_node23"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Router aggregates field confirmations that idle mode engaged&quot;}">
<polygon fill="#f28c28" stroke="black" points="889.88,-308 699.12,-308 699.12,-270 889.88,-270 889.88,-308"/>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-290.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_401_START_IDLE</text>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-275.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_START_IDLE</text>
</a>
</g>
</g>
<!-- S_REQ_301_START_IDLE&#45;&gt;S_CONF_401_START_IDLE -->
<g id="edge28" class="edge">
<title>S_REQ_301_START_IDLE&#45;&gt;S_CONF_401_START_IDLE</title>
<g id="a_edge28"><a xlink:title="{&quot;trigger&quot;: &quot;devices_ack_idle&quot;, &quot;message&quot;: &quot;ID401 START_IDLE_CONFIRM&quot;, &quot;notes&quot;: &quot;Router aggregates START_IDLE confirms&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M474.15,-317.56C537.73,-311.87 621.68,-304.37 687.54,-298.48"/>
<polygon fill="black" stroke="black" points="687.63,-301.98 697.28,-297.6 687.01,-295.01 687.63,-301.98"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-334.77" font-family="Times,serif" font-size="14.00">devices_ack_idle</text>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-318.27" font-family="Times,serif" font-size="14.00">ID401 START_IDLE_CONFIRM</text>
</g>
<!-- S_CONF_401_START_IDLE&#45;&gt;S_IDLE_ROUTER -->
<g id="edge29" class="edge">
<title>S_CONF_401_START_IDLE&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge29"><a xlink:title="{&quot;trigger&quot;: &quot;router_idle_complete&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router returns to idle after broadcast completion&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M698.82,-281.25C596.26,-274.34 427.98,-267.31 283.75,-281.5 235.08,-286.29 181.2,-296.93 139.07,-306.49"/>
<polygon fill="black" stroke="black" points="138.51,-303.03 129.55,-308.68 140.08,-309.85 138.51,-303.03"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-284.7" font-family="Times,serif" font-size="14.00">router_idle_complete</text>
</g>
<!-- S_CONF_402_STOP_IDLE -->
<g id="node25" class="node">
<title>S_CONF_402_STOP_IDLE</title>
<g id="a_node25"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Router aggregates confirmations that idle mode ended&quot;}">
<polygon fill="#f28c28" stroke="black" points="886.12,-204 702.88,-204 702.88,-166 886.12,-166 886.12,-204"/>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-186.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_402_STOP_IDLE</text>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-171.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_STOP_IDLE</text>
</a>
</g>
</g>
<!-- S_REQ_302_STOP_IDLE&#45;&gt;S_CONF_402_STOP_IDLE -->
<g id="edge31" class="edge">
<title>S_REQ_302_STOP_IDLE&#45;&gt;S_CONF_402_STOP_IDLE</title>
<g id="a_edge31"><a xlink:title="{&quot;trigger&quot;: &quot;devices_ack_stop_idle&quot;, &quot;message&quot;: &quot;ID402 STOP_IDLE_CONFIRM&quot;, &quot;notes&quot;: &quot;Router aggregates STOP_IDLE confirms&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M470.29,-210C535.51,-204.95 623.59,-198.14 691.33,-192.9"/>
<polygon fill="black" stroke="black" points="691.24,-196.42 700.94,-192.16 690.7,-189.44 691.24,-196.42"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-227.24" font-family="Times,serif" font-size="14.00">devices_ack_stop_idle</text>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-210.74" font-family="Times,serif" font-size="14.00">ID402 STOP_IDLE_CONFIRM</text>
</g>
<!-- S_CONF_402_STOP_IDLE&#45;&gt;S_IDLE_ROUTER -->
<g id="edge32" class="edge">
<title>S_CONF_402_STOP_IDLE&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge32"><a xlink:title="{&quot;trigger&quot;: &quot;router_resume_active&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router returns to idle after idle&#45;stop broadcast&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M702.66,-175.09C546.18,-159.9 234.06,-138.46 145.75,-198 110.77,-221.58 87.75,-265.9 75.52,-295.44"/>
<polygon fill="black" stroke="black" points="72.34,-293.97 71.91,-304.56 78.84,-296.55 72.34,-293.97"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-166.29" font-family="Times,serif" font-size="14.00">router_resume_active</text>
</g>
<!-- S_CONF_403_PING -->
<g id="node27" class="node">
<title>S_CONF_403_PING</title>
<g id="a_node27"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Router collects alive responses from all devices&quot;}">
<polygon fill="#f28c28" stroke="black" points="865.88,-100 723.12,-100 723.12,-62 865.88,-62 865.88,-100"/>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-82.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_403_PING</text>
<text xml:space="preserve" text-anchor="middle" x="794.5" y="-67.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_PING</text>
</a>
</g>
</g>
<!-- S_REQ_303_PING&#45;&gt;S_CONF_403_PING -->
<g id="edge34" class="edge">
<title>S_REQ_303_PING&#45;&gt;S_CONF_403_PING</title>
<g id="a_edge34"><a xlink:title="{&quot;trigger&quot;: &quot;devices_echo_ping&quot;, &quot;message&quot;: &quot;ID403 PING_CONFIRM&quot;, &quot;notes&quot;: &quot;Router collects ping replies&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M449.94,-103.42C522.31,-98.7 635.07,-91.34 711.5,-86.35"/>
<polygon fill="black" stroke="black" points="711.71,-89.85 721.46,-85.7 711.25,-82.86 711.71,-89.85"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-119.72" font-family="Times,serif" font-size="14.00">devices_echo_ping</text>
<text xml:space="preserve" text-anchor="middle" x="586.25" y="-103.22" font-family="Times,serif" font-size="14.00">ID403 PING_CONFIRM</text>
</g>
<!-- S_CONF_403_PING&#45;&gt;S_IDLE_ROUTER -->
<g id="edge35" class="edge">
<title>S_CONF_403_PING&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge35"><a xlink:title="{&quot;trigger&quot;: &quot;heartbeat_complete&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router returns to idle after heartbeat&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M741.6,-61.52C621.2,-20.03 319.89,61.99 145.75,-83 81.64,-136.38 68.09,-242.19 65.4,-294.4"/>
<polygon fill="black" stroke="black" points="61.92,-293.93 65.01,-304.06 68.91,-294.21 61.92,-293.93"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="378.75" y="-17.34" font-family="Times,serif" font-size="14.00">heartbeat_complete</text>
</g>
<!-- S_CONF_404_RESET -->
<g id="node29" class="node">
<title>S_CONF_404_RESET</title>
<g id="a_node29"><a xlink:title="{&quot;owner&quot;: &quot;ROUTER&quot;, &quot;role&quot;: &quot;confirm&quot;, &quot;description&quot;: &quot;Router aggregates reset confirmations before resuming routing&quot;}">
<polygon fill="#f28c28" stroke="black" points="3911.5,-504 3757.5,-504 3757.5,-466 3911.5,-466 3911.5,-504"/>
<text xml:space="preserve" text-anchor="middle" x="3834.5" y="-486.7" font-family="Helvetica,sans-Serif" font-size="14.00">S_CONF_404_RESET</text>
<text xml:space="preserve" text-anchor="middle" x="3834.5" y="-471.7" font-family="Helvetica,sans-Serif" font-size="14.00">CONFIRM_RESET</text>
</a>
</g>
</g>
<!-- S_REQ_304_RESET&#45;&gt;S_CONF_404_RESET -->
<g id="edge37" class="edge">
<title>S_REQ_304_RESET&#45;&gt;S_CONF_404_RESET</title>
<g id="a_edge37"><a xlink:title="{&quot;trigger&quot;: &quot;devices_ack_reset&quot;, &quot;message&quot;: &quot;ID404 RESET_CONFIRM&quot;, &quot;notes&quot;: &quot;Router aggregates reset confirmations&quot;, &quot;payload&quot;: &quot;device_id,status&quot;}">
<path fill="none" stroke="black" d="M3301.84,-627.54C3414.65,-597.29 3631.43,-539.18 3750.37,-507.29"/>
<polygon fill="black" stroke="black" points="3751,-510.74 3759.75,-504.77 3749.19,-503.98 3751,-510.74"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="3529.12" y="-623.25" font-family="Times,serif" font-size="14.00">devices_ack_reset</text>
<text xml:space="preserve" text-anchor="middle" x="3529.12" y="-606.75" font-family="Times,serif" font-size="14.00">ID404 RESET_CONFIRM</text>
</g>
<!-- S_CONF_404_RESET&#45;&gt;S_IDLE_ROUTER -->
<g id="edge38" class="edge">
<title>S_CONF_404_RESET&#45;&gt;S_IDLE_ROUTER</title>
<g id="a_edge38"><a xlink:title="{&quot;trigger&quot;: &quot;router_reset_complete&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;Router resumes idle after reset loop&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M3757.39,-479.47C3665.29,-472.96 3505.49,-462.24 3368.25,-456 2671.02,-424.29 2496.45,-411 1798.5,-411 377.75,-411 377.75,-411 377.75,-411 274.09,-411 242.07,-425.31 145.75,-387 125.69,-379.02 106.37,-364.56 91.65,-351.61"/>
<polygon fill="black" stroke="black" points="94.41,-349.39 84.66,-345.24 89.7,-354.56 94.41,-349.39"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1797.5" y="-414.2" font-family="Times,serif" font-size="14.00">router_reset_complete</text>
</g>
<!-- S_ERR_500_COMM_ERROR&#45;&gt;S_REQ_304_RESET -->
<g id="edge42" class="edge">
<title>S_ERR_500_COMM_ERROR&#45;&gt;S_REQ_304_RESET</title>
<g id="a_edge42"><a xlink:title="{&quot;trigger&quot;: &quot;mac_recovery_reset&quot;, &quot;message&quot;: &quot;&quot;, &quot;notes&quot;: &quot;MAC responds to COMM_ERROR by issuing broadcast RESET&quot;, &quot;payload&quot;: &quot;&quot;}">
<path fill="none" stroke="black" d="M2835.91,-647C2925.15,-647 3054.72,-647 3139.96,-647"/>
<polygon fill="black" stroke="black" points="3139.91,-650.5 3149.91,-647 3139.91,-643.5 3139.91,-650.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2961.88" y="-650.2" font-family="Times,serif" font-size="14.00">mac_recovery_reset</text>
</g>
<!-- S_ERR_500_COMM_ERROR&#45;&gt;S_ERR_500_COMM_ERROR -->
<g id="edge41" class="edge">
<title>S_ERR_500_COMM_ERROR&#45;&gt;S_ERR_500_COMM_ERROR</title>
<g id="a_edge41"><a xlink:title="{&quot;trigger&quot;: &quot;router_ack_to_esp&quot;, &quot;message&quot;: &quot;ID500 COMM_ERROR&quot;, &quot;notes&quot;: &quot;Router confirms receipt to ESP while escalating to MAC&quot;, &quot;payload&quot;: &quot;device_id,error_code,error_text&quot;}">
<path fill="none" stroke="black" d="M2697.43,-666.42C2692.76,-675.76 2705.37,-684 2735.25,-684 2752.53,-684 2764.03,-681.24 2769.75,-677.12"/>
<polygon fill="black" stroke="black" points="2773,-678.45 2772.62,-667.86 2766.32,-676.38 2773,-678.45"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-703.7" font-family="Times,serif" font-size="14.00">router_ack_to_esp</text>
<text xml:space="preserve" text-anchor="middle" x="2735.25" y="-687.2" font-family="Times,serif" font-size="14.00">ID500 COMM_ERROR</text>
</g>
</g>
</svg>
